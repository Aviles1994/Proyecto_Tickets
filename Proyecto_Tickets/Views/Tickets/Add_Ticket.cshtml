@model Proyecto_Tickets.Models.ViewsModels.AddTicketsViewModel

@{
    ViewBag.Title = "Add_Ticket";
    Layout = "~/Views/Shared/_LayoutDiseño.cshtml";
    List<SelectListItem> items_MC = (List<SelectListItem>)ViewBag.items_MC;
    List<SelectListItem> items_S = (List<SelectListItem>)ViewBag.items_S;
}


@using (Html.BeginForm("Add_Ticket", "Tickets", new { role = "form", Id = "frm", @Class = " form" }))
{
    <main>
        <div class="div_formulario">
            <table class="table">
                <tr>
                    <td> <label for="medio_de_contacto"> Medio de Contacto</label> </td>
                    <td>
                        @Html.DropDownListFor(d => d.ID_MedioContacto, items_MC, "Selecciona el Medio Contacto", new { @class = "form-control" })
                    </td>
                    <td> <label for="servicio"> Servicio</label> </td>
                    <td>
                        @Html.DropDownListFor(d => d.ID_Servico, items_S, "Selecciona el Servicio", new { @class = "form-control" })
                    </td>
                </tr>
                <tr>
                    <td> <label for="nombre_del_Problema"> Nombre del Problema </label> </td>
                    <td> <input type="text" name="nombre_del_problema"> </td>
                    <td> <label for="evidencia">Evidencia</label> </td>
                    <td> <button class="btn" type="button" name="button">Agregar imagen </button> </td>
                </tr>

                <tr>
                    <td> <label for="descripcion_problema">Descripción del Problema</label> </td>
                    <td colspan="3"> <textarea name="descripcion_problema" rows="8" cols="100">Escriba Aqui </textarea> </td>
                </tr>

            <tr>
                <td> <label for="sistema">Sistema</label> </td>
                <td>
                    @if (ViewBag.sistemalist != null)
                    {
                        @Html.DropDownListFor(d => d.ID_Sistema, ViewBag.sistemalist as SelectList, "Seleccione un Sistema", new { @class = "form-control" })
                    }

                </td>
                <td> <label for="modulo"> Modulo</label> </td>
                <td>
                    @Html.DropDownListFor(d => d.ID_Modulo, new SelectList(" "), "Seleccione un Modulo", new { @class = "form-control" })

                </td>
            </tr>
            <tr>
                <td> <label for="pantalla"> Pantalla </label> </td>
                <td>
                    @Html.DropDownListFor(d => d.ID_Pantalla, new SelectList(" "), "Seleccione un Pantalla", new { @class = "form-control" })

                </td>
                <td> <label for="versión"> Versión</label> </td>
                <td> <input type="number" name="versión" value=""> </td>
            </tr>
            <tr>
                <td> <label for="cliente"> Cliente</label> </td>
                <td>
                    @if (ViewBag.clientelist != null)
                    {
                        @Html.DropDownListFor(d=>d.ID_cliente, ViewBag.clientelist as SelectList, "Seleccione un cliente", new { @class="form-control"})
                    }
                </td>
                <td> <label for="usuario_cliente">Usuario del Cliente</label> </td>
                <td>
                    @Html.DropDownListFor(d => d.ID_usuarioCliente, new SelectList(" "), "Seleccione un usuario", new { @class = "form-control" })
                </td>
            </tr>
            <tr>
                <td colspan="4"><button class="button" type="button" name="registrar">Registrar</button></td>
            </tr>
        </table>
    </div>
</main>
}

    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script>
        $(document).ready(function ()
        {
            $('.sidebar-menu').tree();
            $("#ID_cliente").change(function ()
            {
                $.get("/Tickets/GetCliente", { ID_Cliente: $(ID_cliente).val() }, function (data) {
                    $("#ID_usuarioCliente").empty();
                    $.each(data, function (index, row) {
                        $("#ID_usuarioCliente").append("<option value='" + row.ID_Usuario_Cliente + "'>" + row.Nombre_UCliente+"</option>")
                    });
                });
            });
        });

        $(document).ready(function () {
            $("#ID_Sistema").change(function () {
                $.get("/Tickets/GetSistema", { ID_Sistema: $(ID_Sistema).val() }, function (data) {
                    $("#ID_Modulo").empty();
                    $.each(data, function (index, row) {
                        $("#ID_Modulo").append("<option value='" + row.ID_Modulo + "'>" + row.Nombre_Modulo + "</option>")
                    });
                });
            });
        });

        $(document).ready(function () {
            $("#ID_Modulo").change(function () {
                $.get("/Tickets/GetModulo", { ID_Modulo: $(ID_Modulo).val() }, function (data) {
                    $("#ID_Pantalla").empty();
                    $.each(data, function (index, row) {
                        $("#ID_Pantalla").append("<option value='" + row.ID_Pantalla + "'>" + row.Nombre_Pantalla + "</option>")
                    });
                });
            });
        });
 
    </script>